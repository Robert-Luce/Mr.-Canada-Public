$repoUrl = "https://github.com/Robert-Luce/Mr.-Canada-Public.git"
$destinationPath = "C:\Mr.Canada"
if (-not (Test-Path -Path $destinationPath)) {
    New-Item -ItemType Directory -Path $destinationPath | Out-Null
}
$repoName = $repoUrl.Split('/')[-1]
$zipUrl = "$repoUrl/archive/refs/heads/main.zip"
$zipPath = "$destinationPath\$repoName.zip"
Write-Output "Downloading ZIP file from $zipUrl..."
Invoke-WebRequest -Uri $zipUrl -OutFile $zipPath
if (-not (Test-Path -Path $zipPath)) {
    Write-Error "Failed to download the ZIP file. Please check the repository URL and try again."
    exit 1
}
Write-Output "ZIP file downloaded successfully to $zipPath"
Write-Output "Extracting the ZIP file..."
Add-Type -AssemblyName System.IO.Compression.FileSystem
[System.IO.Compression.ZipFile]::ExtractToDirectory($zipPath, $destinationPath)
Write-Output "ZIP file extracted to $destinationPath"
Remove-Item -Path $zipPath
Write-Output "Download and extraction complete."
